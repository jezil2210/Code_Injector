# Code_Injector

## Used Modules

###  netfilterqueue

NetfilterQueue provides access to packets matched by an iptables rule in Linux. Packets so matched can be accepted, dropped, altered, or given a mark. The iptables is the tool to access the linux netfilter firewall, the iptable rule we're gonna set to redirect the flow of packets to a queue to be analyzed, and then all packets that have the destination for the port 80(HTTP) we're gonna to redirect to the port 10000 which is the sslstrip port(the tool SslStrip is used to bypass HTTPS websites). Remembering tha we can just do this because first we become the MITM using the file which is in the repository Arp_Spoof.

### Scapy

The module Scapy is used to edit the packets from the queue because with the original format there is no way to edit for more information go to the repository Arp_Spoof. First of all already the MITM i analyse all the requests and responses, because my iptable rule that i set i redirected the request that want to go for the port 80 to the port 10000(SslStrip), with this i can see all the requests with the destination 10000 and using regex rules access the field "Accept-Encoding" and remove the encoding from the packet, this way is possible to see the information about the packet and change, the same way i replace the field with "HTTP/1.1" fro an earlies version to avoid problems. Therefore the problem when the target make the requests is done, now when the progam check a response from the server (originnaly the response would come with the source port 80 but now came from the port 10000 because of my SslStrip tool) it's gonna inject the code in the field "load" that contains the HTML and scripts from the page that the target requested. Looking for a tag </body> that all HTML pages have and replacing with a java script code. Other importants details is change the length of the page because when a page is sent to someone it has a length and how it was changed because of the injecting code we have to change the verify if the load have the field content_length and recalculate the length adding the length of the injected code. Lastly but not least how the format of the packet was change to a scapy pakcet we have to take the packet and turn into a orginal packet. 
